#!/usr/bin/env bash

BUILD_DIR=$1
CACHE_DIR=$2

NODE_VERSION=v8.9.0
NODE_DIST=node-${NODE_VERSION}-linux-x64
NODE_TAR=${NODE_DIST}.tar.xz

echo "Downloading node $NODE_VERSION..."
curl -sL https://nodejs.org/dist/${NODE_VERSION}/${NODE_TAR} -o ${CACHE_DIR}/${NODE_TAR}

[ !-f ${CACHE_DIR}/${NODE_TAR} ] && echo "Not found"

echo "Download complete, extracting downloaded content..."
tar xf ${CACHE_DIR}/${NODE_TAR}

echo "Installing node $NODE_VERSION"
mkdir -p ${BUILD_DIR}/bin
mv ${NODE_DIST} ${BUILD_DIR}/bin

${BUILD_DIR}/bin/${NODE_DIST}/node -v

exit 0